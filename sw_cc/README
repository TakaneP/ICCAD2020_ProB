V1 merge
I have run the test and ensured the demand after parsing is right.

Todo: 
      1. Fix bugs of segment tree
